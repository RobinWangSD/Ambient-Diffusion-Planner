GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Global seed set to 1024
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/8
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 8 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Number of scenarios in train_boston dataset: 118177
Number of scenarios in train_pittsburgh dataset: 117914
Number of scenarios in train_singapore dataset: 107331
Number of scenarios in train_vegas_1 dataset: 95959
Number of scenarios in train_vegas_2 dataset: 95797
Number of scenarios in train_vegas_3 dataset: 91540
Number of scenarios in train_vegas_4 dataset: 109579
Number of scenarios in train_vegas_5 dataset: 119200
Number of scenarios in train_vegas_6 dataset: 120000
Total number of scenarios in pred dataset: 975497
Number of scenarios in val dataset: 120000
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]

   | Name                      | Type                    | Params
-----------------------------------------------------------------------
0  | pred_backbone             | Backbone                | 4.4 M
1  | pred_map_encoder          | MapEncoder              | 501 K
2  | pred_decoder_head         | TwoLayerMLP             | 148 K
3  | plan_backbone             | Backbone                | 4.4 M
4  | plan_map_encoder          | MapEncoder              | 501 K
5  | plan_decoder_head         | TwoLayerMLP             | 148 K
6  | cls_loss                  | CrossEntropyLoss        | 0
7  | token_cls_acc             | TokenClsAcc             | 0
8  | min_joint_ade             | minJointADE             | 0
9  | min_joint_fde             | minJointFDE             | 0
10 | reward                    | CumulativeReward        | 0
11 | on_road_reward            | OnRoadReward            | 0
12 | agent_collision_reward    | AgentCollisionReward    | 0
13 | obstacle_collision_reward | ObstacleCollisionReward | 0
14 | speed_limit_reward        | SpeedLimitReward        | 0
15 | comfort_reward            | ComfortReward           | 0
16 | progress_reward           | ProgressReward          | 0
17 | ttc_reward                | TTCReward               | 0
-----------------------------------------------------------------------
10.1 M    Trainable params
0         Non-trainable params
10.1 M    Total params
40.290    Total estimated model params size (MB)
Epoch 6:  52%|██████████████████▎                | 7986/15243 [1:18:49<1:11:37,  1.69it/s, v_num=hdiy, train_cls_loss_step=3.450, val_token_cls_acc=0.301, val_cls_loss=3.580, val_min_joint_ade=1.220, val_min_joint_fde=3.390, train_cls_loss_epoch=3.520]
                                                                                                                                                                                                                                                            
